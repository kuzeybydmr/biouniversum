{% extends "base.html" %}
{% block content %}
<h2>Search Publications</h2>
<form method="get" class="search-form">
    <input type="text" name="q" placeholder="Enter keyword..." value="{{ query }}">
    <select name="year">
        <option value="">All Years</option>
        {% for y in years %}
            <option value="{{ y }}" {% if selected_year==y %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
    </select>

    <button type="submit">Search</button>
    <button type="submit" formaction="{{ url_for('bestmatch') }}">Find Matching Article</button>
</form>

{% if results %}
    <table class="results-table" border="1" cellpadding="5" cellspacing="0">
        <thead>
            <tr>
                <th>Title</th>
                <th>Year</th>
            </tr>
        </thead>
        <tbody>
        {% for row in results %}
            <tr>
                <td><a href="{{ url_for('article', article_id=row['id']) }}">{{ row['title'] }}</a></td>
                <td>{{ row.get('year', '') }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% elif query %}
    <p>No results found.</p>
{% endif %}
{% endblock %}
